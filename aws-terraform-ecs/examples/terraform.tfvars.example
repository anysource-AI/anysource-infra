# ========================================
# Example Configuration for ECS Terraform Module
# ========================================
# Copy this file to terraform.tfvars and update with your actual values
# Choose ONE of the deployment modes below based on your needs

# ========================================
# Module Version
# ========================================
# Specify which version of the runlayer-infra module to use
# Examples: "v1.0.0", "v1.1.0"
release_version = "v1.0.0"

# ========================================
# MODE 1: NEW VPC + NEW ECS CLUSTER (Full Stack)
# ========================================
# Use this mode to create a new ECS cluster with new VPC, RDS, Redis, and all infrastructure
# This is the default mode - values below are for MODE 1

# No additional configuration needed for new VPC - it will be created automatically

# ========================================
# MODE 2: EXISTING VPC + NEW ECS CLUSTER
# ========================================
# Use this mode to create a new ECS cluster in an existing VPC
# Uncomment the lines below and comment out MODE 1 settings above

# Network Configuration - Use existing VPC
# vpc_id             = "vpc-0a1b2c3d4e5f67890"
# private_subnet_ids = ["subnet-0a1b2c3d", "subnet-1e2f3g4h", "subnet-2i3j4k5l"]
# public_subnet_ids  = ["subnet-6m7n8o9p", "subnet-7q8r9s0t", "subnet-8u9v0w1x"]

# Requirements for existing VPC:
# - At least 3 private subnets in different availability zones
# - At least 3 public subnets in different availability zones
# - Private subnets must have internet access via NAT Gateway
# - Public subnets must have internet gateway attached

# ========================================
# COMMON CONFIGURATION (All Modes)
# ========================================

# Auth Configuration (provided by Runlayer support)
auth_client_id = "CHANGE_ME_AUTH_CLIENT_ID" # Replace with your auth client ID
auth_api_key   = "CHANGE_ME_AUTH_API_KEY"   # Replace with your auth API key

#Use the public images provided by Runlayer (default) or override with your own private ECR images
# ecr_repositories = {
#   backend  = "public.ecr.aws/mycompany/anysource-api:v1.0.0"
#   frontend = "public.ecr.aws/mycompany/anysource-web:v1.0.0"
#   worker   = "public.ecr.aws/mycompany/anysource-worker:v1.0.0"
# }

# ACM Certificate ARN for your domain (required for HTTPS)
# ssl_certificate_arn = "arn:aws:acm:us-east-1:123456789012:certificate/your-certificate-id"

# ========================================
# OPTIONAL CONFIGURATION
# ========================================
# Uncomment and customize as needed - module has sensible defaults

# Monitoring Configuration
# enable_monitoring = true
# sentry_dsn       = "https://your-sentry-dsn@sentry.io/project-id"

# WAF IP Allowlisting Configuration
# Enable to restrict ALB access to specific IPv4 CIDR blocks
# waf_enable_ip_allowlisting = true
# waf_allowlist_ipv4_cidrs   = [
#   "203.0.113.0/24",    # Example: Office network
#   "198.51.100.42/32",  # Example: Specific IP address
# ]

# Route53 + ACM DNS validation (also creates ALIAS record automatically)
# enable_acm_dns_validation = true
# hosted_zone_name          = "yourzone.example.com"

# Bedrock Guardrail Configuration
# Sensitivity level for prompt attack detection (LOW, MEDIUM, or HIGH)
# bedrock_prompt_guard_sensitivity = "MEDIUM" # Default: MEDIUM

# Dual ALB Configuration for Split-Horizon DNS
# Enable to create both a public ALB (for internet access) and an internal ALB (for private network access)
# Useful when you need the same domain name to resolve differently based on network location
# enable_dual_alb = true
# private_hosted_zone_id = ""  # Optional: Use existing private hosted zone ID
# private_hosted_zone_vpc_id = ""  # Optional: VPC ID for private hosted zone (defaults to service VPC)
# private_hosted_zone_additional_vpc_ids = []  # Optional: Additional VPCs to associate with private zone

# VPC Peering Configuration (Cross-Account/Cross-VPC Connectivity)
# Enable VPC peering to allow traffic between the Runlayer VPC and other VPCs
# IMPORTANT: Only works when module creates the VPC (not with existing_vpc_id)
# SECURITY: peer_owner_id is REQUIRED to ensure connections from known sources
# Connections are automatically accepted after validation
# vpc_peering_connections = {
#   "customer-vpc" = {
#     peering_connection_id = "pcx-0abc123def456"  # VPC peering connection ID from the initiating side
#     peer_vpc_cidr         = "172.16.0.0/16"      # CIDR block of the peer VPC
#     peer_owner_id         = "123456789012"        # AWS account ID of the peer (REQUIRED)
#     peer_region           = "us-east-1"           # AWS region of the peer (optional, for cross-region)
#   }
# }
